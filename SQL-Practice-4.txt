SQL SUB QUERY CASE 1:

1. QUERY TO DISPLAY THE EMPLOYEE NAMES WHOSE NAME AS 2ND CHARACTER SHOULD BE '0'?

SELECT ENAME
FROM EMP
WHERE ENAME LIKE('_O%');

2. QUERY TO DISPLAY ALL THE EMPLOYEES WHO'S DEPT NUMBER IS SAME AS SCOTT?

SELECT * 
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO
FROM EMP
WHERE ENAME='SCOTT');

3. LIST THE EMPLOYEES WHO HAS SALARY GREATER THAN MILLER?

SELECT *
FROM EMP
WHERE SAL>(SELECT SAL
FROM EMP
WHERE ENAME='MILLER');

4. DISPLAY THE LOCATION OF AN EMPLOYEE IN ACCOUNTING DEPARTMENT?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN(SELECT DEPTNO
FROM DEPT
WHERE DNAME='ACCOUNTING');

5. WRITE A QUERY TO DISPLAY ALL THE EMPLOYEE WHOSE JOB NOT SAME AS ALLEN AND SALARY IS GREATER THAN MARTIN?

SELECT *
FROM EMP
WHERE JOB NOT IN(SELECT JOB
FROM EMP
WHERE ENAME='ALLEN' AND SAL>(SELECT SAL
FROM EMP
WHERE ENAME='MARTIN'));

6. DISPLAY ALL THE EMPLOYEES WHO IS HAVING LOCATION IS SAME AS ADAM'S MANAGER?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN(SELECT DEPTNO
FROM EMP
WHERE ENAME=('ADAMS') OR JOB=('MANAGER'));

7. LIST THE EMPLOYEES WHO JOINED AFTER 2 YEARS OF FIRST EMPLOYEE OF THE COMPANY AND MORE THAN BLAKE SALARY?

SELECT *
FROM EMP
WHERE HIREDATE > (SELECT ADD_MONTHS(MIN(HIREDATE),2*12)
FROM EMP)
AND SAL > (SELECT SAL
FROM EMP
WHERE ENAME='BLAKE');              


8. LIST ALL THE EMPLOYEES WHOSE JOB IS SAME AS JONES AND THEIR SALARY LESSER THAN SCOTT?

SELECT *
FROM EMP
WHERE JOB IN(SELECT JOB
FROM EMP
WHERE ENAME='JONES' AND SAL<(SELECT SAL
FROM EMP
WHERE ENAME='SCOTT'));

9. DISPLAY ALL THE EMPLOYEES OF DEPARTMENT 30, 20 WITH THERE ANUAL SALARY AND HAVING ATLEAST 3 EMPLOYEES?

SELECT EMP.*,SAL*12 "ANNUAL SALARY"
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>=3);

10. DISPLAY ALL THE EMPLOYEES WHO ARE EARN LESS THAN ANY OF THE SALESMAN?

SELECT *
FROM EMP
WHERE SAL< ANY(SELECT SAL
FROM EMP
WHERE JOB='SALESMAN');

11. DISPLAY ALL THE EMPLOYEES WHO ARE JOINED BEFORE THE LAST PERSON?

SELECT ENAME
FROM EMP
WHERE HIREDATE<(SELECT MAX(HIREDATE)
FROM EMP);

12. DISPLAY ALL THE EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE MANAGER?

SELECT *
FROM EMP
WHERE SAL > ANY(SELECT MAX(SAL)
FROM EMP
WHERE MGR IN(SELECT MGR
FROM EMP));

13. LIST EMPLOYEES WHO JOINED AFTER 4 YEARS OF 1ST EMPLOYEE OF THE COMPANY AND LESS THAN BLAKE SALARY?

SELECT *
FROM EMP
WHERE HIREDATE>(SELECT ADD_MONTHS(MIN(HIREDATE),4*12)
FROM EMP)
AND SAL<(SELECT SAL
FROM EMP
WHERE ENAME='BLAKE');

14. DISPLAY THE DEPARTMENT INFORMATION OF EMPLOYEE IS WORKING FOR NEW YORK LOCATION?

SELECT *
FROM DEPT
WHERE LOC='NEW YORK';

15. DISPLAY THE EMPLOYEE DETAILS WITH THEIR ANNUAL SALARY WHO EARN MAXIMUM COMMISSION?

SELECT EMP.*,SAL*12 ANNUAL_SALARY
FROM EMP
WHERE COMM IN(SELECT MAX(COMM)
FROM EMP);

16. DISPLAY THE LAST EMPLOYEE RECORD WITH 25% HIKE IN SALARY?

SELECT EMP.*,SAL+SAL*25/100 HIKE
FROM EMP
WHERE HIREDATE IN (SELECT MAX(HIREDATE)
FROM EMP);

17. DISPLAY LAST EMPLOYEE RECORD ACCORDING TO EMPNO?

SELECT *
FROM EMP
WHERE EMPNO IN(SELECT MAX(EMPNO)
FROM EMP);

18. DISPLAY ALL THE EMPLOYEE WHOSE SALARY IS GREATER THAN AVERAGE SALARY OF DEPARTMENT 30.?

SELECT *
FROM EMP
WHERE SAL > (SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO=30);

19. DISPLAY THE DEPARTMENT NAMES THAT ARE HAVING ATLEAST ONE 'L' IN IT?

SELECT DNAME
FROM DEPT
WHERE DNAME LIKE('%L%');

20. DISPLAY ALL THE EMPLOYEES WHO ARE JOINED AFTER BLAKE?

SELECT *
FROM EMP
WHERE HIREDATE > (SELECT HIREDATE
FROM EMP
WHERE ENAME='BLAKE');

21. WRITE A QUERY TO DISPLAY THE EMPLOYEE INFORMATION WHO IS NOT TAKING COMMISSION AND JOINED COMPANY AFTER JULY 83?

SELECT *
FROM EMP
WHERE COMM IS NULL AND HIREDATE >('31-JULY-83');

22. DISPLAY DEPARTMENT WISE MINIMUM SALARY WHICH IS LESS THAN AVERAGE SALARY OF EMPLOYEES?

SELECT MIN(SAL),DEPTNO
FROM EMP
WHERE SAL <(SELECT AVG(SAL)
FROM EMP)
GROUP BY DEPTNO;

23. DISPLAY THE NAMES OF EMPLOYEE FROM DEPARTMENT NUMBER 10 WITH SALARY GREATER THAN THAT OF ALL EMPLOYEE WORKING IN OTHER DEPARTMENTS?

SELECT ENAME
FROM EMP
WHERE DEPTNO=10 AND SAL > ALL(SELECT SAL
FROM EMP
WHERE DEPTNO<>10);

24. DISPLAY THE NAMES OF EMPLOYEES WHO EARN HIGHEST SALARY IN THEIR RESPECTIVE JOBS?

SELECT ENAME
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP
GROUP BY JOB);

25. DISPLAY THE EMPLOYEE NUMBER AND NAME OF EMPLOYEE WORKING AS CLERK AND EARNING HIGHEST SALARY AMONG CLERKS?

SELECT EMPNO,ENAME
FROM EMP
WHERE JOB='CLERK' AND SAL IN(SELECT MAX(SAL)
FROM EMP
WHERE JOB='CLERK');

26. DISPLAY ALL THE EMPLOYEES SALARY IS GREATER THAN AVG SAL OF DEPARTMENT 20?

SELECT *
FROM EMP
WHERE DEPTNO=20 AND SAL > (SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO=20);

27. DISPLAY EMPNO, ENAME, JOB, WHOSE JOB HAS 'E' IN IT AND DISPLAY EMPNO IN DESCENDING ORDER?

SELECT EMPNO,ENAME,JOB
FROM EMP
WHERE JOB LIKE('%E%') 
ORDER BY EMPNO DESC;

28. DISPLAY DETAILS OF SMITH AND EMPLOYEES WORKING AS PRESIDENT ALONG WITH HIKE OF 35% IN SALARY?

SELECT ENAME,SAL+SAL*35/100 HIKE
FROM EMP
WHERE JOB='PRESIDENT';

29. DISPLAY NUMBER OF EMPLOYEES WHOSE COMMISSION IS MORE THAN SALARY?

SELECT COUNT(*)
FROM EMP
WHERE COMM > SAL;

30. LIST THE EMPLOYEES WHOSE DAILY SALARY IS GREATER THAN 1500 AND WHO ARE JOINED BEFORE 1982 ONLY?

SELECT *
FROM EMP
WHERE SAL/30 > 1500 AND HIREDATE <('01-JAN-1982');

31. DISPLAY NUMBER OF EMPLOYEES WHOSE COMMISSION IS MORE THAN SALARY?

SELECT COUNT(*)
FROM EMP
WHERE COMM > SAL;

32. DISPLAY ALL THE EMPLOYEES WHOSE NAME START WITH 'S' AND HAVING SALARY MORE THAN 'ALLEN' AND LESS THAN FORD?

SELECT ENAME
FROM EMP
WHERE ENAME LIKE('S%') AND SAL > (SELECT SAL
FROM EMP
WHERE ENAME='ALLEN') AND SAL< (SELECT SAL
FROM EMP 
WHERE ENAME='FORD');

33. DISPLAY ALL THE CLERKS AND ANALYST WHO ARE NOT WORKING 'DALLAS' ?

SELECT *
FROM EMP
WHERE JOB IN('CLERK','ANALYST') AND DEPTNO IN(SELECT DEPTNO
FROM DEPT
WHERE LOC!='DALLAS');

34. DISPLAY MAXIMUM SALARY OF 'SALES' DEPARTMENT?

SELECT MAX(SAL)
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO
FROM DEPT
WHERE DNAME='SALES');

35. DISPLAY ALL THE EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE MANAGER (JOB)?

SELECT *
FROM EMP
WHERE SAL > ANY (SELECT SAL
FROM EMP
WHERE JOB='MANAGER');

36. SELECT EMPNO, JOB AND SALARY OF ALL THE ANALYST WHO ARE EARNING MORE THAN ANY OF THE MANAGER JOB?

SELECT EMPNO,JOB,SAL
FROM EMP
WHERE SAL IN(SELECT SAL
FROM EMP
WHERE JOB='ANALYST') AND SAL > ANY (SELECT SAL
FROM EMP
WHERE JOB='MANAGER');

37. DISPLAY ALL THE EMPLOYEES WHOSE SALARY IS GREATER THAN AVG SAL OF DEPARTMENT 20?

SELECT *
FROM EMP
WHERE SAL > (SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO=20);

38. DISPLAY ALL THE EMPLOYEES WHO GETS MAXIMUM SALARY?

SELECT *
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP);

39. DISPLAY FIRST EMPLOYEE RECORD BASED ON HIREDATE?

SELECT *
FROM EMP
WHERE HIREDATE IN (SELECT MIN(HIREDATE)
FROM EMP);

CASE 2:

1. DISPLAY ALL THE EMPLOYEES WHOSE DEPARTMET NAMES ENDING 'S'

SELECT ENAME
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO
FROM DEPT
WHERE DNAME LIKE ('%S'));

2. QUERY TO DISPLAY THE EMPLOYEE NAMES WHO IS HAVING MAXIMUM SALARY IN DEPT NAME "ACCOUNTING"?

SELECT *
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP
WHERE DEPTNO IN(SELECT DEPTNO
FROM DEPT
WHERE DNAME='ACCOUNTING'));

3. QUERY TO DISPLAY THE DEPT NAME WHO IS HAVING HIGHEST COMMISSION?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE COMM IN (SELECT MAX(COMM)
FROM EMP));

4. QUERY TO DISPLAY ALL THE EMPLOYEES IN 'OPERATIONS AND ACCOUNTING' DEPT?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME IN ('OPERATIONS','ACCOUNTING'));

5. LIST DEPARTMENT NAME HAVING ATLEAST 3 SALESMAN?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='SALESMAN'
GROUP BY DEPTNO
HAVING COUNT(*)>=3);

6. DISPLAY ALL EMPLOYESS DO NOT HAVE ANY REPORTER?

SELECT *
FROM EMP
WHERE EMPNO NOT IN (SELECT MGR
FROM EMP
WHERE MGR IS NOT NULL);

7. DISPLAY THE DEPARTNAME OF THE EMPLOYEE NAME DOES NOT STARTS WITH S AND SALARY BETWEEN 1500 TO 3000?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE ENAME NOT LIKE ('S%') AND (SAL BETWEEN 1500 AND 3000));

8. DISPLAY LOCATION OF EMPLOYEE WHOSE SALARY IS MINIMUM SALARY BUT SALARY IS GREATER THAN 2000?

SELECT LOC 
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL IN (SELECT MIN(SAL)
FROM EMP
WHERE SAL > 2000));

9. DISPLAY THE DEPARTMENT LOCATION THAT IS HAVING GREATER THAN FOUR EMPLOYEES IN IT?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>4);

10. LIST EMPLOYEES WHO LOCATED IN CHICAGO AND THEIR COMMISSION IS ZERO?

SELECT ENAME
FROM EMP
WHERE DEPTNO=(SELECT DEPTNO
FROM DEPT
WHERE LOC= ('CHICAGO')) AND COMM =0;

11. LIST EMPLOYEES WHO WORK FOR SALES DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='SALES') AND SAL >(SELECT AVG(SAL)
FROM EMP);

12. LIST EMPLOYEES WHO ARE WORKING IN RESEARCH DEPARTMENT AND THEY ARE MANAGER?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='RESEARCH' AND JOB='MANAGER');

13. DISPLAY DEPARTMENT NAME OF THE EMPLOYEES WHO EARN COMMISSION?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE COMM IS NOT NULL);

14. DISPLAY LOCATION OF EMPLOYEES, WHOSE NAME DOESN'T START WITH A AND SALARY BETWEEN 1000 AND 3000?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE ENAME NOT LIKE ('A%') AND (SAL BETWEEN 1000 AND 3000));

15. DISPLAY ALL THE EMPLOYEE WHOSE DEPARTMENT IS SALES AND WHO IS EARNING SOME COMMISSION (I.E COMMISSION IS NOT NULL OR ZERO) AND
WHO IS HIRED BEFORE THE LAST PERSON HIRED?

SELECT ENAME
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='SALES') AND COMM>=0 AND HIREDATE<(SELECT MAX(HIREDATE)
FROM EMP);

16. DISPLAY DEPARTMENT NAMES OF EMPLOYEE'S WHOSE SALARY IS GREATER THAN AVERAGE SALARY OF ALL THE CLERK'S ?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL >(SELECT AVG(SAL)
FROM EMP
WHERE JOB='CLERK'));

17. DISPLAY THE DEPARTMENT NUMBER WORKING IN SALES DEPARTMENT AND THEY ARE MANAGER?

SELECT DEPTNO
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE DNAME=('SALES') AND JOB='MANAGER');

18. DISPLAY HIREDATE AND JOB OF ALL THE EMPLOYEES WORKING FOR SALES?

SELECT HIREDATE,JOB
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='SALES');

19. DISPLAY LOCATION AND DNAME OF EMPLOYEE WHO WORKING AS PRESIDENT ?

SELECT LOC,DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='PRESIDENT');

20. DISPLAY THE DNAME OF EMPLOYEES WHOES SALARY IS MAXIMUM SALARY BUT LESSER THAN 3000?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP
WHERE SAL <3000));

21. DISPLAY THE NUMBER OF EMPLOYEES WHO WORK FOR RESEARCH DEPT AND THEIR SALARY IS LESSER THAN ONE OF THE SALARY IN DEPARTMENT IN 10?

SELECT COUNT(*)
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='RESEARCH') AND SAL < (SELECT MAX(SAL)
FROM EMP
WHERE DEPTNO=10);

22. DISPLAY THE DNAME THAT ARE HAVING CLERK IN IT?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='CLERK');

23. LIST THE DEPT NAME THAT ARE HAVING AT LEAST 3 EMPLOYEES BUT NOT MORE THAN 5 EMPLOYEES IN IT?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>=3 AND COUNT(*)<5);

24. SELECT THE EMPLOYEES WHOSE DNAME IS HAVING AT LEAST TWO 'E' IN IT?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE DNAME LIKE ('%E%E%'));

25. DISPLAY ENAME,SAL OF EMPLOYEES WHO ARE EARNING MORE THAN ANY OF THE ANALYST?

SELECT ENAME,SAL
FROM EMP
WHERE SAL > ANY (SELECT SAL
FROM EMP
WHERE JOB='ANALYST');

26. SELECT ALL THE EMPLOYEES WHO ARE WORKING FOR CHICAGO?

SELECT *
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE LOC='CHICAGO');

27. QUERY TO DISPLAY EMPLOYEE NAMES WHO IS HAVING MINIMUM SALARY IN DEPARTMENT RESEARCH?

SELECT ENAME
FROM EMP
WHERE SAL IN (SELECT MIN(SAL)
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='RESEARCH'));

28. LIST THE DEPARTMENT NAMES THAT ARE HAVING SALESMAN?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='SALESMAN');

29. LIST THE DEPARTMENT NAMES THAT ARE HAVING AT LEAST 3 EMPLOYES IN IT?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*)>=3);

30. DISPLAY THE LOCATION OF ALL THE DEAPRTMENTS WHICH HAVE EMPLOYEES JOINED IN THE YEAR 81?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE HIREDATE LIKE ('%81'));

31. DISPLAY ALL THE EMPLOYEE INFORMATION WHO ARE LIVING IN A LOCATION WHICH IS HAVING AT LEAST 2 'O' IN IT?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME LIKE ('%O%O%'));

32. LIST THE NUMBER OF EMPLOYEES WHOSE JOB IS SALESMAN WORKING FOR NEWYORK AND CHICAGO?

SELECT COUNT(*)
FROM EMP
WHERE JOB='SALESMAN' AND DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE LOC IN ('NEWYORK','CHICAGO'));

33. LIST THE DEPARTMENT NAMES IN WHICH THE EMPLOYEES ARE HIRED BETWEEN 1ST OF JAN 1981 AND 31ST DEC 1982 WITH SALARY MORE THAN 1800?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE HIREDATE BETWEEN '01-JAN-1981' AND '31-DEC-1982' AND SAL > 1800);

34. LIST EMPLOYEES WHO WORKS FOR ACCOUNTING DEPARTMENT AND THEIR SALARY GREATER THAN AVERAGE SALARY OF THEIR DEPARTMENT?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='ACCOUNTING') AND SAL > (SELECT AVG(SAL)
FROM EMP);

35. DISPLAY LOCATION OF THE EMPLOYEE EARN COMMISSION?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE COMM IS NOT NULL);

36. DISPLAY LOC AND DNAME WHOSE JOB IS MANAGER AND HAS SAL LESS THAN CLERK?

SELECT LOC,DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='MANAGER' AND SAL > (SELECT MIN(SAL)
FROM EMP
WHERE JOB='CLERK'));

37. DISPLAY EMPLOYEES LOCATION WHO HAS SOME
COMMISSION?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE COMM IS NOT NULL);

38. DISPLAY AVG SALARY OF ALL EMPLOYEES WHOSE DEPT NAME IS ACCOUNTING?

SELECT AVG(SAL)
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME='ACCOUNTING');

39. DISPLAY ALL THE EMPLOYEES WHOSE JOB SAME AS 'SMITH' AND DEPARTMENT SAME AS 'JONES' AND SALARY MORE THAN 'TURNER'?

SELECT *
FROM EMP
WHERE JOB IN (SELECT JOB
FROM EMP
WHERE ENAME='SMITH') AND DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE ENAME='JONES')) AND SAL > (SELECT SAL
FROM EMP
WHERE ENAME='TURNER');

40.  SELECT ENAME OF EMPLOYEE WHO EARNS 2ND MAX SALARY AND WORKS FOR LOCATION DALLAS?

SELECT ENAME
FROM EMP
WHERE SAL < (SELECT MAX(SAL)
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE LOC='DALLAS'));

41. SELECT THE DEPARTMENT NAME AND LOCATION OF ALL THE EMPLOYEES WORKING FOR CLARK?

SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='CLERK');

42. SELECT ALL THE EMPLOYEES WORKING FOR DALLAS?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE LOC='DALLAS');

COMPLETE SUBQUERY
--------------------------------

1. DISPLAY THE JOB, MANAGER OF EMPLOYEES WHO IS WORKING FOR JONES?

SELECT ENAME,JOB,MGR
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='JONES');

2. DISPLAY THE EMPLOYEE NAMES, HIGHER DATE, COMMISSION OF FORD'S MANAGER?

SELECT ENAME,HIREDATE,COMM
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE ENAME='FORD');

3. DISPLAY THE NUMBER OF EMPLOYEES ARE GETTING SALARY LESS THAN THE BLAKE'S MANAGER?

SELECT COUNT(*)
FROM EMP
WHERE SAL<(SELECT SAL
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE ENAME='BLAKE'));

4. DISPLAY DEPARTMENT NAME OF THE EMPLOYEE EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP 
WHERE MGR IS NULL));

5. DISPLAY EMPLOYEE DETAILS WHO ARE REPORTING TO BLAKE AND HAVE COMMISSION WITHOUT USING NULL OR NOT NULL?

SELECT *
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='BLAKE')AND COMM IS NOT NULL;

6. LIST ALL THE DEPTNAME AND LOC OF ALL THE SALESMAN 
MANAGER-MANAGER'S?

SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE JOB='SALESMAN')));

7. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK ,REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN SALARY?

SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='CLERK' AND MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='BLAKE') AND SAL<(SELECT SAL
FROM EMP
WHERE ENAME='MARTIN'));

8. LIST THE EMPLOYEES WHO DOES NOT DIRECTLY REPORT TO PRESIDENT,HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL?

SELECT *
FROM EMP
WHERE MGR!=(SELECT EMPNO
FROM EMP
WHERE JOB='PRESIDENT') AND COMM IS NOT NULL AND SAL>ALL(SELECT MAX(SAL)
FROM EMP
WHERE JOB='CLERK');

9. DISPLAY ALL THE DEPARTMENT NAMES FOR WARD'S MANAGER'S MANAGER?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE ENAME='WARD')));

10. DISPLAY DEPARTMENT NAME OF THE EMPLOYEE WHO EARN MINMUM SALARY AND HAVE REPORTING MANAGER?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL IN(SELECT MIN(SAL) 
FROM EMP
WHERE MGR IS NOT NULL));

11. WRITE A QUERY TO DISPLAY EMPLOYEE NAME, JOB,LOCATION OF ALL EMPLOYEES WHO ARE WORKING AS MANAGER AND WORKS AT CHICAGO?

SELECT ENAME,JOB,LOC
FROM EMP E1,DEPT D1
WHERE E1.DEPTNO IN (SELECT E1.DEPTNO 
FROM EMP
WHERE E1.JOB='MANAGER' AND D1.LOC='CHICAGO');

12. LIST EMPLOYEES FROM SALES AND RESEARCH DEPARTMENT HAVING ATLEAST 2 REPORTING EMPLOYEES?

SELECT ENAME
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME IN('SALES','RESEARCH')) AND EMPNO IN(SELECT MGR
FROM EMP
GROUP BY MGR HAVING COUNT(*)>=2);

13. LIST EMPLOYEES WHO HAVE COMMISSION GREATER THAN MAXIMUM SALARY OF ALL THE SALESMAN AND WHO DO NOT REPORT TO KING DIRECTLY?

SELECT *
FROM EMP
WHERE COMM >(SELECT MAX(SAL) 
FROM EMP
WHERE JOB='SALESMAN') AND MGR!=(SELECT EMPNO
FROM EMP
WHERE ENAME='KING');

14. LIST THE EMPLOYEES WHO DOES NOT DIRECTLY REPORT TO PRESIDENT,HAVE COMMISSION AND SALARY MORE THAN MAX SALARY OF ALL THE CLERK WITHOUT USING NULL OR NOT NULL?

SELECT *
FROM EMP
WHERE MGR!=(SELECT EMPNO
FROM EMP
WHERE JOB='PRESIDENT') AND COMM IS NOT NULL AND SAL>ALL(SELECT MAX(SAL)
FROM EMP
WHERE JOB='CLERK');

15. LIST THE EMPLOYEE DEPTNAME AND LOC OF ALL THE EMPLOYEES WHO ARE CLERK ,REPORTING TO BLAKE AND SALARY IS LESSER THAN MARTIN SALARY?

SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='CLERK' AND MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='BLAKE')
AND SAL<(SELECT SAL
FROM EMP 
WHERE ENAME='MARTIN'));

EMPLOYEE MANAGER RELATION
----------------------------------------------

1. DISPLAY ALL EMPLOYESS WHO DO NOT HAVE ANY REPORTER?

SELECT *
FROM EMP
WHERE EMPNO NOT IN (SELECT MGR
FROM EMP
WHERE MGR IS NOT NULL);

2. LIST ALL THE EMPLOYEES WHO ARE REPORTING TO JONES MANAGER?

SELECT ENAME
FROM EMP
WHERE MGR IN (SELECT MGR
FROM EMP
WHERE ENAME='JONES');

3. LIST EMPLOYEES FROM RESEARCH&ACCOUNTING HAVING ATLEAST 2
REPORTING?

SELECT ENAME
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME IN('RESEARCH','ACCOUNTING') AND EMPNO IN (SELECT MGR
FROM EMP
GROUP BY MGR
HAVING COUNT(*)>=2));

4. DISPLAY LOCATION OF ALL THE EMPLOYEES WHO REPORTING TO BLAKE?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='BLAKE'));

5. DISPLAY DEPARTMENT NAME OF ALL THE EMPLOYEES WHO ARE REPORTING TO BLAKE?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='BLAKE'));

6. DISPLAY MARTIN'S MANAGER'S MANAGER'S DEPARTMENT NAME AND LOCATION?

SELECT DNAME,LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE ENAME='MARTIN')));

7. DISPLAY THE MANAGER NAME,JOB AND DEPARTMENT NUMBER FOR THOSE WHO DON'T HAVE COMMISSION?

SELECT MGR,ENAME,JOB,DEPTNO
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE COMM IS NULL);

8. DISPLAY THE DEPARTMENT NAME WHO ARE REPORTING TO ADAMS?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='ADAMS'));

9. DISPLAY THE LOCATION OF ALL EMPLOYEES REPORTING MANAGER SALARY IS GREATER THAN 2000?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE SAL>2000));

10. LIST EMPLOYEES FROM RESEARCH AND ACCOUNTING DEPARTMENT HAVING ATLEAST TWO REPORTING?

SELECT *
FROM EMP
WHERE DEPTNO IN (SELECT DEPTNO
FROM DEPT
WHERE DNAME IN ('RESEARCH','ACCOUNTING') AND EMPNO IN (SELECT MGR
FROM EMP
GROUP BY MGR
HAVING COUNT(*)>=2));

11. DISPLAY ALL THE EMPLOYEES ARE REPORTING TO 'JONES'?

SELECT ENAME
FROM EMP
WHERE MGR IN (SELECT EMPNO
FROM EMP
WHERE ENAME='JONES');

12. WRITE A QUERY TO FIND SMITH'S MANAGER'S MANAGER HIREDATE?

SELECT HIREDATE
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE EMPNO IN (SELECT MGR
FROM EMP
WHERE ENAME='SMITH'));

13. DISPLAY LOCATION OF THE EMPLOYEE EARN MAXIMUM SALARY AND HAVE NO REPORTING MANAGER?

SELECT LOC
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL IN (SELECT MAX(SAL)
FROM EMP
WHERE MGR IS NULL));

14. DISPLAY DNAME, LOC,DEPTNO OF EMPLOYEES WHO HAS SAME REPORTING MANAGER???

SELECT DNAME,LOC,DEPTNO
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE MGR IN (SELECT MGR
FROM EMP));

15. DISPLAY DEPARTMENT NAME WHICH IS HAVING AT LEAST ONE 'MANAGER'?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE JOB='MANAGER'
GROUP BY DEPTNO
HAVING COUNT(*)>=1);

NESTED QUERIES
------------------------
1. FIND 3RD MINIMUM SALARY IN THE EMPLOYEE TABLE?

SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN (SAL)
FROM EMP));

2. DISPLAY THE 2ND MAXIMUM SALARY ?

 SELECT MAX(SAL)
 FROM EMP
 WHERE SAL<(SELECT MAX(SAL)
 FROM EMP);

3. DISPLAY THE DEPT NAME OF THE EMP WHO GETS 3RD MAXIMUM SALARY?

SELECT DNAME
FROM DEPT
WHERE DEPTNO IN (SELECT DEPTNO
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP))));

4. DISPLAY THE 3RD MAXIMUM SALARY?

SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP));

5. DISPLAY THE 5TH MAXIMUM SALARY?

SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP));

6. DISPLAY THE 7TH MAXIMUM SALARY?

SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP
WHERE SAL<(SELECT MAX(SAL)
FROM EMP))))));

7. DISPLAY THE 3RD MINIMUM SALARY?

SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP));

8. DISPLAY THE 10TH MINIMUM SALARY?

SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP
WHERE SAL>(SELECT MIN(SAL)
FROM EMP)))))))));

